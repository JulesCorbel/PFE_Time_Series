lines(ARIMAMSETrimTest, col="red")
ARIMAMSETrimTest
lines(ARIMAMSETrimTest$model, col="red")
ARIMAMSETrimTest$model
lines(ARIMAMSETrimTest$method, col="red")
ARIMAMSETrimTest$mean
ARIMAMSETrimTest
lines(ARIMAMSETrimTest$mean, col="red")
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim=c(1300000000,1570000000))
lines(ARIMAMSETrimTest$mean, col="red")
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim=c(1350000000,1570000000))
lines(ARIMAMSETrimTest$mean, col="red")
0
0
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim=c(1300000000,1570000000))
lines(ARIMAMSETrimTest$mean, col="red")
ARIMAMSEAnnTest <- forecast(ARIMAMSEAnnTrain, h = 2)
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle")
lines(ARIMAMSEAnnTest$mean, col="red")
lines(ARIMAMSEAnnTest$mean, col="red")
ARIMAMSEAnnTest$mean
lines(ARIMAMSEAnnTest$mean, col="red", ylim=c(5000000000,6000000000))
ARIMAMSEAnnTest <- forecast(ARIMAMSEAnnTrain, h = 2)
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5000000000,6000000000))
lines(ARIMAMSEAnnTest$mean, col="red")
plot(MSEAnnTest, type='l', ylim=c(5000000000,6000000000),
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale annuelle")
lines(LEMSEAnnPred, col="red")
LEMSEAnnPred
LEMSEAnnPred <- forecast(LEMSEAnn, h = 2)
LEMSEAnnPred
setwd("/home/gis3/pguillot/PFE/PFE_Time_Series")
library(tseries)
library(forecast)
annuelle <- read.csv("Data/Data_Annuel.csv", sep=";", dec=",", nrows=30)
trim <- read.csv("Data/Data_Trim.csv", sep=";", dec=",")
###Séries temporelles MSE
MSEAnn <- ts(annuelle$MSE, start = 1990, end = 2019)
MSETrim <- ts(trim$MSE, start=c(1990,1), end = c(2017,4), frequency = 4)
plot(MSEAnn, main="Evolution annuelle de la masse salariale")
plot(MSETrim, main="Evolution trimestrielle de la masse salariale")
acf(MSEAnn, main="Auto-corrélation de la masse salariale annuelle", na.action=na.pass)
pacf(MSEAnn, main="Auto-corrélation partielle de la masse salariale annuelle", na.action=na.pass)
acf(MSETrim, main="Auto-corrélation de la masse salariale trimestrielle", na.action=na.pass)
pacf(MSETrim, main="Auto-corrélation partielle de la masse salariale trimestrielle", na.action=na.pass)
#On sépare les séries : modélisations jusque 2015, prévision à partir de 2016
MSEAnnTrain <- window(MSEAnn, start=1990, end=2015)
MSETrimTrain <- window(MSETrim, start=1990, end=c(2015,4))
MSEAnnTest <- window(MSEAnn, start=2016)
MSETrimTest <- window(MSETrim, start=2016)
##Modélisation par Holt-Winter
LEMSEAnn <- HoltWinters(MSEAnnTrain,alpha=NULL,beta=NULL,gamma=FALSE)
LEMSETrim <- HoltWinters(MSETrimTrain,alpha=NULL,beta=NULL,gamma=NULL, seasonal = "mul")
LEMSEAnnPred <- forecast(LEMSEAnn, h = 2)
LEMSETrimPred <- forecast(LEMSETrim, h = 6)
plot(MSEAnnTest, type='l', ylim=c(5000000000,6000000000),
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale annuelle")
lines(LEMSEAnnPred, col="red")
plot(MSETrimTest, type='l',
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale trimestrielle")
lines(LEMSETrimPred, col='red')
##Modèles SARIMA
MSEAnnTrainStat <- diff(MSEAnnTrain, differences = 2, lag = 1)
#Stationnarisation de la série
temp <- diff(MSETrimTrain, differences = 1, lag = 1)
MSETrimTrainStat <- diff(temp, differences = 1, lag = 4)
plot(MSETrimTrainStat, main="Masse salariale trimestrielle avec une différence de 1
et une saisonnalité de 4")
Box.test(MSETrimTrainStat, type = "Ljung-Box")
acf(MSETrimTrainStat, main="Auto-corrélation de la masse salariale trimestrielle")
pacf(MSETrimTrainStat, main="Auto-corrélation partielle de la masse salariale trimestrielle")
#Train
ARIMAMSETrimTrain <- auto.arima(MSETrimTrain, stationary = F)
plot(MSETrimTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale trimestrielle")
lines(ARIMAMSETrimTrain$fitted, col="red")
ARIMAMSEAnnTrain <- auto.arima(MSEAnnTrain, stationary = F)
plot(MSEAnnTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale annuelle")
lines(ARIMAMSEAnnTrain$fitted, col="red")
#Test
ARIMAMSETrimTest <- forecast(ARIMAMSETrimTrain, h=7)
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim=c(1300000000,1570000000))
lines(ARIMAMSETrimTest$mean, col="red")
ARIMAMSEAnnTest <- forecast(ARIMAMSEAnnTrain, h = 2)
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5000000000,6000000000))
lines(ARIMAMSEAnnTest$mean, col="red")
plot(MSEAnnTest, type='l', ylim=c(5000000000,6000000000),
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale annuelle")
lines(LEMSEAnnPred$mean, col="red")
plot(MSETrimTest, type='l',
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale trimestrielle")
lines(LEMSETrimPred$mean, col='red')
setwd("/home/gis3/pguillot/PFE/PFE_Time_Series")
library(tseries)
library(forecast)
annuelle <- read.csv("Data/Data_Annuel.csv", sep=";", dec=",", nrows=30)
trim <- read.csv("Data/Data_Trim.csv", sep=";", dec=",")
###Séries temporelles MSE
MSEAnn <- ts(annuelle$MSE, start = 1990, end = 2019)
MSETrim <- ts(trim$MSE, start=c(1990,1), end = c(2017,4), frequency = 4)
plot(MSEAnn, main="Evolution annuelle de la masse salariale")
plot(MSETrim, main="Evolution trimestrielle de la masse salariale")
acf(MSEAnn, main="Auto-corrélation de la masse salariale annuelle", na.action=na.pass)
pacf(MSEAnn, main="Auto-corrélation partielle de la masse salariale annuelle", na.action=na.pass)
acf(MSETrim, main="Auto-corrélation de la masse salariale trimestrielle", na.action=na.pass)
pacf(MSETrim, main="Auto-corrélation partielle de la masse salariale trimestrielle", na.action=na.pass)
#On sépare les séries : modélisations jusque 2015, prévision à partir de 2016
MSEAnnTrain <- window(MSEAnn, start=1990, end=2015)
MSETrimTrain <- window(MSETrim, start=1990, end=c(2015,4))
MSEAnnTest <- window(MSEAnn, start=2016)
MSETrimTest <- window(MSETrim, start=2016)
##Modélisation par Holt-Winter
LEMSEAnn <- HoltWinters(MSEAnnTrain,alpha=NULL,beta=NULL,gamma=FALSE)
LEMSETrim <- HoltWinters(MSETrimTrain,alpha=NULL,beta=NULL,gamma=NULL, seasonal = "mul")
LEMSEAnnPred <- forecast(LEMSEAnn, h = 2)
LEMSETrimPred <- forecast(LEMSETrim, h = 6)
plot(MSEAnnTest, type='l', ylim=c(5000000000,6000000000),
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale annuelle")
lines(LEMSEAnnPred$mean, col="red")
plot(MSETrimTest, type='l',
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale trimestrielle")
lines(LEMSETrimPred$mean, col='red')
##Modèles SARIMA
MSEAnnTrainStat <- diff(MSEAnnTrain, differences = 2, lag = 1)
#Stationnarisation de la série
temp <- diff(MSETrimTrain, differences = 1, lag = 1)
MSETrimTrainStat <- diff(temp, differences = 1, lag = 4)
plot(MSETrimTrainStat, main="Masse salariale trimestrielle avec une différence de 1
et une saisonnalité de 4")
Box.test(MSETrimTrainStat, type = "Ljung-Box")
acf(MSETrimTrainStat, main="Auto-corrélation de la masse salariale trimestrielle")
pacf(MSETrimTrainStat, main="Auto-corrélation partielle de la masse salariale trimestrielle")
#Train
ARIMAMSETrimTrain <- auto.arima(MSETrimTrain, stationary = F)
plot(MSETrimTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale trimestrielle")
lines(ARIMAMSETrimTrain$fitted, col="red")
ARIMAMSEAnnTrain <- auto.arima(MSEAnnTrain, stationary = F)
plot(MSEAnnTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale annuelle")
lines(ARIMAMSEAnnTrain$fitted, col="red")
#Test
ARIMAMSETrimTest <- forecast(ARIMAMSETrimTrain, h=7)
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim=c(1300000000,1570000000))
lines(ARIMAMSETrimTest$mean, col="red")
ARIMAMSEAnnTest <- forecast(ARIMAMSEAnnTrain, h = 2)
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5000000000,6000000000))
lines(ARIMAMSEAnnTest$mean, col="red")
MSETrimTest
ARIMAMSETrimTest <- forecast(ARIMAMSETrimTrain, h=6)
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim=c(1300000000,1570000000))
lines(ARIMAMSETrimTest$mean, col="red")
setwd("/home/gis3/pguillot/PFE/PFE_Time_Series")
library(tseries)
library(forecast)
annuelle <- read.csv("Data/Data_Annuel.csv", sep=";", dec=",", nrows=30)
trim <- read.csv("Data/Data_Trim.csv", sep=";", dec=",")
###Séries temporelles MSE
MSEAnn <- ts(annuelle$MSE, start = 1990, end = 2019)
MSETrim <- ts(trim$MSE, start=c(1990,1), end = c(2017,4), frequency = 4)
plot(MSEAnn, main="Evolution annuelle de la masse salariale")
plot(MSETrim, main="Evolution trimestrielle de la masse salariale")
acf(MSEAnn, main="Auto-corrélation de la masse salariale annuelle", na.action=na.pass)
pacf(MSEAnn, main="Auto-corrélation partielle de la masse salariale annuelle", na.action=na.pass)
acf(MSETrim, main="Auto-corrélation de la masse salariale trimestrielle", na.action=na.pass)
pacf(MSETrim, main="Auto-corrélation partielle de la masse salariale trimestrielle", na.action=na.pass)
#On sépare les séries : modélisations jusque 2015, prévision à partir de 2016
MSEAnnTrain <- window(MSEAnn, start=1990, end=2010)
MSETrimTrain <- window(MSETrim, start=1990, end=c(2010,4))
MSEAnnTest <- window(MSEAnn, start=2011)
MSETrimTest <- window(MSETrim, start=2011)
##Modélisation par Holt-Winter
LEMSEAnn <- HoltWinters(MSEAnnTrain,alpha=NULL,beta=NULL,gamma=FALSE)
LEMSETrim <- HoltWinters(MSETrimTrain,alpha=NULL,beta=NULL,gamma=NULL, seasonal = "mul")
LEMSEAnnPred <- forecast(LEMSEAnn, h = 2)
LEMSETrimPred <- forecast(LEMSETrim, h = 6)
plot(MSEAnnTest, type='l', ylim=c(5000000000,6000000000),
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale annuelle")
lines(LEMSEAnnPred$mean, col="red")
plot(MSETrimTest, type='l',
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale trimestrielle")
lines(LEMSETrimPred$mean, col='red')
##Modèles SARIMA
MSEAnnTrainStat <- diff(MSEAnnTrain, differences = 2, lag = 1)
#Stationnarisation de la série
temp <- diff(MSETrimTrain, differences = 1, lag = 1)
MSETrimTrainStat <- diff(temp, differences = 1, lag = 4)
plot(MSETrimTrainStat, main="Masse salariale trimestrielle avec une différence de 1
et une saisonnalité de 4")
Box.test(MSETrimTrainStat, type = "Ljung-Box")
acf(MSETrimTrainStat, main="Auto-corrélation de la masse salariale trimestrielle")
pacf(MSETrimTrainStat, main="Auto-corrélation partielle de la masse salariale trimestrielle")
#Train
ARIMAMSETrimTrain <- auto.arima(MSETrimTrain, stationary = F)
plot(MSETrimTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale trimestrielle")
lines(ARIMAMSETrimTrain$fitted, col="red")
ARIMAMSEAnnTrain <- auto.arima(MSEAnnTrain, stationary = F)
plot(MSEAnnTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale annuelle")
lines(ARIMAMSEAnnTrain$fitted, col="red")
#Test
ARIMAMSETrimTest <- forecast(ARIMAMSETrimTrain, h=6)
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim=c(1300000000,1570000000))
lines(ARIMAMSETrimTest$mean, col="red")
ARIMAMSEAnnTest <- forecast(ARIMAMSEAnnTrain, h = 2)
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5000000000,6000000000))
lines(ARIMAMSEAnnTest$mean, col="red")
setwd("/home/gis3/pguillot/PFE/PFE_Time_Series")
library(tseries)
library(forecast)
annuelle <- read.csv("Data/Data_Annuel.csv", sep=";", dec=",", nrows=30)
trim <- read.csv("Data/Data_Trim.csv", sep=";", dec=",")
###Séries temporelles MSE
MSEAnn <- ts(annuelle$MSE, start = 1990, end = 2019)
MSETrim <- ts(trim$MSE, start=c(1990,1), end = c(2017,4), frequency = 4)
plot(MSEAnn, main="Evolution annuelle de la masse salariale")
plot(MSETrim, main="Evolution trimestrielle de la masse salariale")
acf(MSEAnn, main="Auto-corrélation de la masse salariale annuelle", na.action=na.pass)
pacf(MSEAnn, main="Auto-corrélation partielle de la masse salariale annuelle", na.action=na.pass)
acf(MSETrim, main="Auto-corrélation de la masse salariale trimestrielle", na.action=na.pass)
pacf(MSETrim, main="Auto-corrélation partielle de la masse salariale trimestrielle", na.action=na.pass)
#On sépare les séries : modélisations jusque 2015, prévision à partir de 2016
MSEAnnTrain <- window(MSEAnn, start=1990, end=2010)
MSETrimTrain <- window(MSETrim, start=1990, end=c(2010,4))
MSEAnnTest <- window(MSEAnn, start=2011)
MSETrimTest <- window(MSETrim, start=2011)
##Modélisation par Holt-Winter
LEMSEAnn <- HoltWinters(MSEAnnTrain,alpha=NULL,beta=NULL,gamma=FALSE)
LEMSETrim <- HoltWinters(MSETrimTrain,alpha=NULL,beta=NULL,gamma=NULL, seasonal = "mul")
LEMSEAnnPred <- forecast(LEMSEAnn, h = 2)
LEMSETrimPred <- forecast(LEMSETrim, h = 6)
plot(MSEAnnTest, type='l', ylim=c(5000000000,6000000000),
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale annuelle")
lines(LEMSEAnnPred$mean, col="red")
plot(MSETrimTest, type='l',
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale trimestrielle")
lines(LEMSETrimPred$mean, col='red')
##Modèles SARIMA
MSEAnnTrainStat <- diff(MSEAnnTrain, differences = 2, lag = 1)
#Stationnarisation de la série
temp <- diff(MSETrimTrain, differences = 1, lag = 1)
MSETrimTrainStat <- diff(temp, differences = 1, lag = 4)
plot(MSETrimTrainStat, main="Masse salariale trimestrielle avec une différence de 1
et une saisonnalité de 4")
Box.test(MSETrimTrainStat, type = "Ljung-Box")
acf(MSETrimTrainStat, main="Auto-corrélation de la masse salariale trimestrielle")
pacf(MSETrimTrainStat, main="Auto-corrélation partielle de la masse salariale trimestrielle")
#Train
ARIMAMSETrimTrain <- auto.arima(MSETrimTrain, stationary = F)
plot(MSETrimTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale trimestrielle")
lines(ARIMAMSETrimTrain$fitted, col="red")
ARIMAMSEAnnTrain <- auto.arima(MSEAnnTrain, stationary = F)
plot(MSEAnnTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale annuelle")
lines(ARIMAMSEAnnTrain$fitted, col="red")
#Test
ARIMAMSETrimTest <- forecast(ARIMAMSETrimTrain, h=6)
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim=c(1300000000,1570000000))
lines(ARIMAMSETrimTest$mean, col="red")
ARIMAMSEAnnTest <- forecast(ARIMAMSEAnnTrain, h = 2)
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5000000000,6000000000))
lines(ARIMAMSEAnnTest$mean, col="red")
plot(MSEAnnTest, type='l',
main="Comparaison entre la prédiction du lissage exponentiel et les valeurs
réelles pour la masse salariale annuelle")
lines(LEMSEAnnPred$mean, col="red")
lines(LEMSEAnnPred$mean, col="red")
LEMSEAnnPred$mean
LEMSEAnnPred <- forecast(LEMSEAnn, h = 7)
LEMSEAnn <- HoltWinters(MSEAnnTrain,alpha=NULL,beta=NULL,gamma=FALSE)
LEMSETrim <- HoltWinters(MSETrimTrain,alpha=NULL,beta=NULL,gamma=NULL, seasonal = "mul")
LEMSEAnnPred <- forecast(LEMSEAnn, h = 7)
LEMSETrimPred <- forecast(LEMSETrim, h = 26)
plot(MSEAnnTest, type='l',
main="Comparaison entre la prédiction du lissage exponentiel et les valeurs
réelles pour la masse salariale annuelle")
lines(LEMSEAnnPred$mean, col="red")
LEMSEAnnPred$mean
setwd("/home/gis3/pguillot/PFE/PFE_Time_Series")
library(tseries)
library(forecast)
annuelle <- read.csv("Data/Data_Annuel.csv", sep=";", dec=",", nrows=30)
trim <- read.csv("Data/Data_Trim.csv", sep=";", dec=",")
###Séries temporelles MSE
MSEAnn <- ts(annuelle$MSE, start = 1990, end = 2019)
MSETrim <- ts(trim$MSE, start=c(1990,1), end = c(2017,4), frequency = 4)
plot(MSEAnn, main="Evolution annuelle de la masse salariale")
plot(MSETrim, main="Evolution trimestrielle de la masse salariale")
acf(MSEAnn, main="Auto-corrélation de la masse salariale annuelle", na.action=na.pass)
pacf(MSEAnn, main="Auto-corrélation partielle de la masse salariale annuelle", na.action=na.pass)
acf(MSETrim, main="Auto-corrélation de la masse salariale trimestrielle", na.action=na.pass)
pacf(MSETrim, main="Auto-corrélation partielle de la masse salariale trimestrielle", na.action=na.pass)
#On sépare les séries : modélisations jusque 2015, prévision à partir de 2016
MSEAnnTrain <- window(MSEAnn, start=1990, end=2012)
MSETrimTrain <- window(MSETrim, start=1990, end=c(2012,4))
MSEAnnTest <- window(MSEAnn, start=2013)
MSETrimTest <- window(MSETrim, start=2013)
##Modélisation par Holt-Winter
LEMSEAnn <- HoltWinters(MSEAnnTrain,alpha=NULL,beta=NULL,gamma=FALSE)
LEMSETrim <- HoltWinters(MSETrimTrain,alpha=NULL,beta=NULL,gamma=NULL, seasonal = "mul")
LEMSEAnnPred <- forecast(LEMSEAnn, h = 5)
LEMSETrimPred <- forecast(LEMSETrim, h = 18)
plot(MSEAnnTest, type='l',
main="Comparaison entre la prédiction du lissage exponentiel et les valeurs
réelles pour la masse salariale annuelle")
lines(LEMSEAnnPred$mean, col="red")
plot(MSETrimTest, type='l',
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale trimestrielle")
lines(LEMSETrimPred$mean, col='red')
##Modèles SARIMA
MSEAnnTrainStat <- diff(MSEAnnTrain, differences = 2, lag = 1)
#Stationnarisation de la série
temp <- diff(MSETrimTrain, differences = 1, lag = 1)
MSETrimTrainStat <- diff(temp, differences = 1, lag = 4)
plot(MSETrimTrainStat, main="Masse salariale trimestrielle avec une différence de 1
et une saisonnalité de 4")
Box.test(MSETrimTrainStat, type = "Ljung-Box")
acf(MSETrimTrainStat, main="Auto-corrélation de la masse salariale trimestrielle")
pacf(MSETrimTrainStat, main="Auto-corrélation partielle de la masse salariale trimestrielle")
#Train
ARIMAMSETrimTrain <- auto.arima(MSETrimTrain, stationary = F)
plot(MSETrimTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale trimestrielle")
lines(ARIMAMSETrimTrain$fitted, col="red")
ARIMAMSEAnnTrain <- auto.arima(MSEAnnTrain, stationary = F)
plot(MSEAnnTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale annuelle")
lines(ARIMAMSEAnnTrain$fitted, col="red")
#Test
ARIMAMSETrimTest <- forecast(ARIMAMSETrimTrain, h=6)
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim=c(1300000000,1570000000))
lines(ARIMAMSETrimTest$mean, col="red")
ARIMAMSEAnnTest <- forecast(ARIMAMSEAnnTrain, h = 2)
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5000000000,6000000000))
lines(ARIMAMSEAnnTest$mean, col="red")
setwd("/home/gis3/pguillot/PFE/PFE_Time_Series")
library(tseries)
library(forecast)
annuelle <- read.csv("Data/Data_Annuel.csv", sep=";", dec=",", nrows=30)
trim <- read.csv("Data/Data_Trim.csv", sep=";", dec=",")
###Séries temporelles MSE
MSEAnn <- ts(annuelle$MSE, start = 1990, end = 2019)
MSETrim <- ts(trim$MSE, start=c(1990,1), end = c(2017,4), frequency = 4)
plot(MSEAnn, main="Evolution annuelle de la masse salariale")
plot(MSETrim, main="Evolution trimestrielle de la masse salariale")
acf(MSEAnn, main="Auto-corrélation de la masse salariale annuelle", na.action=na.pass)
pacf(MSEAnn, main="Auto-corrélation partielle de la masse salariale annuelle", na.action=na.pass)
acf(MSETrim, main="Auto-corrélation de la masse salariale trimestrielle", na.action=na.pass)
pacf(MSETrim, main="Auto-corrélation partielle de la masse salariale trimestrielle", na.action=na.pass)
#On sépare les séries : modélisations jusque 2015, prévision à partir de 2016
MSEAnnTrain <- window(MSEAnn, start=1990, end=2012)
MSETrimTrain <- window(MSETrim, start=1990, end=c(2012,4))
MSEAnnTest <- window(MSEAnn, start=2013)
MSETrimTest <- window(MSETrim, start=2013)
##Modélisation par Holt-Winter
LEMSEAnn <- HoltWinters(MSEAnnTrain,alpha=NULL,beta=NULL,gamma=FALSE)
LEMSETrim <- HoltWinters(MSETrimTrain,alpha=NULL,beta=NULL,gamma=NULL, seasonal = "mul")
LEMSEAnnPred <- forecast(LEMSEAnn, h = 5)
LEMSETrimPred <- forecast(LEMSETrim, h = 18)
plot(MSEAnnTest, type='l',
main="Comparaison entre la prédiction du lissage exponentiel et les valeurs
réelles pour la masse salariale annuelle")
lines(LEMSEAnnPred$mean, col="red")
plot(MSETrimTest, type='l',
main="Comparaison entre la prédiction du modèle et les valeurs
réelles pour la masse salariale trimestrielle")
lines(LEMSETrimPred$mean, col='red')
##Modèles SARIMA
MSEAnnTrainStat <- diff(MSEAnnTrain, differences = 2, lag = 1)
#Stationnarisation de la série
temp <- diff(MSETrimTrain, differences = 1, lag = 1)
MSETrimTrainStat <- diff(temp, differences = 1, lag = 4)
plot(MSETrimTrainStat, main="Masse salariale trimestrielle avec une différence de 1
et une saisonnalité de 4")
Box.test(MSETrimTrainStat, type = "Ljung-Box")
acf(MSETrimTrainStat, main="Auto-corrélation de la masse salariale trimestrielle")
pacf(MSETrimTrainStat, main="Auto-corrélation partielle de la masse salariale trimestrielle")
#Train
ARIMAMSETrimTrain <- auto.arima(MSETrimTrain, stationary = F)
plot(MSETrimTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale trimestrielle")
lines(ARIMAMSETrimTrain$fitted, col="red")
ARIMAMSEAnnTrain <- auto.arima(MSEAnnTrain, stationary = F)
plot(MSEAnnTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale annuelle")
lines(ARIMAMSEAnnTrain$fitted, col="red")
#Test
ARIMAMSETrimTest <- forecast(ARIMAMSETrimTrain, h=6)
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim=c(1300000000,1570000000))
lines(ARIMAMSETrimTest$mean, col="red")
ARIMAMSEAnnTest <- forecast(ARIMAMSEAnnTrain, h = 2)
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5000000000,6000000000))
lines(ARIMAMSEAnnTest$mean, col="red")
LEMSEAnnPred$mean
plot(MSEAnnTest, type='l', ylim=c(5400000000,6300000000),
main="Comparaison entre la prédiction du lissage exponentiel et les valeurs
réelles pour la masse salariale annuelle")
lines(LEMSEAnnPred$mean, col="red")
plot(MSETrimTest, type='l',
main="Comparaison entre la prédiction du lissage exponentiel et les valeurs
réelles pour la masse salariale trimestrielle")
lines(LEMSETrimPred$mean, col='red')
plot(MSETrimTest, type='l', ylim=c(1300000000,1700000000),
main="Comparaison entre la prédiction du lissage exponentiel et les valeurs
réelles pour la masse salariale trimestrielle")
lines(LEMSETrimPred$mean, col='red')
plot(MSETrimTrainStat, main="Masse salariale trimestrielle avec une différence de 1
et une saisonnalité de 4")
plot(MSEAnnTrainStat)
MSEAnnTrainStat <- diff(MSEAnnTrain, differences = 1, lag = 1)
plot(MSEAnnTrainStat)
acf(MSEAnnTrainStat)
pacf(MSEAnnTrainStat)
acf(MSEAnnTrainStat, lag=30)
MSEAnnTrainStat <- diff(MSEAnnTrain, differences = 2, lag = 1)
plot(MSEAnnTrainStat)
acf(MSEAnnTrainStat, lag=30)
pacf(MSEAnnTrainStat)
acf(MSEAnnTrainStat, lag=30)
pacf(MSEAnnTrainStat)
temp <- diff(MSETrimTrain, differences = 1, lag = 1)
MSETrimTrainStat <- diff(temp, differences = 1, lag = 4)
plot(MSETrimTrainStat, main="Masse salariale trimestrielle avec une différence de 1
et une saisonnalité de 4")
Box.test(MSETrimTrainStat, type = "Ljung-Box")
acf(MSETrimTrainStat, main="Auto-corrélation de la masse salariale trimestrielle")
pacf(MSETrimTrainStat, main="Auto-corrélation partielle de la masse salariale trimestrielle")
ARIMAMSETrimTrain <- auto.arima(MSETrimTrain, stationary = F)
plot(MSETrimTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale trimestrielle")
lines(ARIMAMSETrimTrain$fitted, col="red")
ARIMAMSEAnnTrain <- auto.arima(MSEAnnTrain, stationary = F)
plot(MSEAnnTrain, main="Comparaison entre le modèle et les données d'apprentissage
pour la masse salariale annuelle")
lines(ARIMAMSEAnnTrain$fitted, col="red")
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim=c(1300000000,1570000000))
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle")
lines(ARIMAMSETrimTest$mean, col="red")
ARIMAMSETrimTest <- forecast(ARIMAMSETrimTrain, h = 18)
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle")
lines(ARIMAMSETrimTest$mean, col="red")
ARIMAMSETrimTest$mean
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim = c(1350000000,17000000000))
lines(ARIMAMSETrimTest$mean, col="red")
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim = c(135000000,1700000000))
lines(ARIMAMSETrimTest$mean, col="red")
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim = c(1350000000,1700000000))
lines(ARIMAMSETrimTest$mean, col="red")
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5000000000,6000000000))
lines(ARIMAMSEAnnTest$mean, col="red")
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5000000000,6000000000))
lines(ARIMAMSEAnnTest$mean, col="red")
ARIMAMSEAnnTest$mean
ARIMAMSEAnnTest <- forecast(ARIMAMSEAnnTrain, h = 5)
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5400000000,6500000000))
lines(ARIMAMSEAnnTest$mean, col="red")
ARIMAMSEAnnTest$mean
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5400000000,7200000000))
lines(ARIMAMSEAnnTest$mean, col="red")
ARIMAMSEAnnTrain
ARIMAMSETrimTrain
ARIMAMSETrimTest <- forecast(ARIMAMSETrimTrain, h = 18)
plot(MSETrimTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale trimestrielle", ylim = c(1350000000,1700000000))
lines(ARIMAMSETrimTest$mean, col="red")
ARIMAMSEAnnTest <- forecast(ARIMAMSEAnnTrain, h = 5)
plot(MSEAnnTest, main="Comparaison entre le modèle et les données de validation
pour la masse salariale annuelle", ylim=c(5400000000,7200000000))
lines(ARIMAMSEAnnTest$mean, col="red")
